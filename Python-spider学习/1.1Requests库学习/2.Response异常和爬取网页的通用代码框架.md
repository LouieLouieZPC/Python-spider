# çˆ¬å–ç½‘é¡µçš„é€šç”¨ä»£ç æ¡†æ¶

ä½¿å¾—ç”¨æˆ·çˆ¬å–ç½‘é¡µæ›´ç¨³å®šã€å¯é 

## ä¸€ã€åŸºç¡€

1. Requestsåº“æ”¯æŒ6ç§å¸¸ç”¨çš„å¼‚å¸¸ï¼š

|å¼‚å¸¸|è¯´æ˜|
|---|---|
|requests.ConnectionError|ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼Œå¦‚DNSæŸ¥è¯¢å¤±è´¥ï¼Œæ‹’ç»è¿æ¥ç­‰|
|requests.HTTPError|HTTPé”™è¯¯å¼‚å¸¸|
|requests.URLRequired|URLç¼ºå¤±å¼‚å¸¸|
|requests.TooManyRedirects|è¶…è¿‡æœ€å¤§é‡å®šå‘æ¬¡æ•°ï¼Œäº§ç”Ÿé‡å®šå‘å¼‚å¸¸|
|requests.ConnectTimeout|è¿æ¥è¿œç¨‹æœåŠ¡å™¨è¶…æ—¶å¼‚å¸¸|
|requests.Timeout|è¯·æ±‚URLè¶…æ—¶ï¼Œäº§ç”Ÿè¶…æ—¶å¼‚å¸¸|


2. Responseå¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼š  
`r.raise_for_status()`   :å¦‚æœ`status_code`ä¸æ˜¯200ï¼Œäº§ç”Ÿå¼‚å¸¸`request.HTTPError`


3.e.g.:
```python
import requests
from requests.exceptions import ReadTimeout,ConnectTimeout,RequestException     # å¯¼å…¥request.exceptionsä¸‹çš„å„ç§å¼‚å¸¸é”™è¯¯ä¸‹çš„å„ç§å¼‚å¸¸é”™è¯¯


try:      # æŠŠè¯·æ±‚æ”¾åœ¨tryä¸‹
    response=requests.get('http://httpbin.org/get',timeout=0.5)
    print(response.status_code)
except ReadTimeout:    # æŠŠå¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ç”¨exceptè·å–
    print('Timeout')    # è¶…æ—¶å¼‚å¸¸
except ConnectTimeout: # æŠŠå¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ç”¨exceptè·å–
    print('Connection error')    # è¿æ¥å¼‚å¸¸
except RequestException:  # æŠŠå¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ç”¨exceptè·å–
    print('Error')      # è¯·æ±‚å¼‚å¸¸
```




## äºŒã€çˆ¬å–ç½‘é¡µçš„é€šç”¨ä»£ç æ¡†æ¶ï¼š
```python
import requests
def getHTMLText(url):
    try:
        r=requests.get(url,timeout=20)
        r.raise_for_status()   # ğŸ‘å¦‚æœçŠ¶æ€ä¸æ˜¯200ï¼Œå¼•å‘HTTPErrorå¼‚å¸¸
        r.encoding=r.apparent_encoding
        return r.text
    except:                   # æŠŠå¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ç”¨exceptè·å–
        return 'äº§ç”Ÿå¼‚å¸¸(raise exception)'

if __name__ == "__main__":
    url='http://www.baidu.com'
    print(getHTMLText(url))
```